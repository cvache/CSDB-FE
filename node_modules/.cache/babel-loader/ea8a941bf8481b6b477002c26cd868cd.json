{"ast":null,"code":"var _jsxFileName = \"/Users/carsonvache/Documents/CrowdsourcedMedicalImageDatabase/notes-front-end/src/containers/Notes.js\";\nimport React, { useRef, useState, useEffect } from \"react\";\nimport { useParams, useHistory } from \"react-router-dom\";\nimport { FormGroup, FormControl, ControlLabel } from 'react-bootstrap';\nimport { API, Storage } from \"aws-amplify\";\nimport LoaderButton from \"../components/LoaderButton\";\nimport { onError } from \"../libs/errorLib\";\nimport config from \"../config\";\nimport './Notes.css';\nexport default function Notes() {\n  const file = useRef(null);\n  const {\n    id\n  } = useParams();\n  const history = useHistory();\n  const [note, setNote] = useState(null);\n  const [content, setContent] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [isDeleting, setIsDeleting] = useState(false);\n  useEffect(() => {\n    function loadNote() {\n      return API.get(\"notes\", `/notes/${id}`);\n    }\n\n    async function onLoad() {\n      try {\n        const note = await loadNote();\n        const {\n          content,\n          attatchment\n        } = note;\n\n        if (attatchment) {\n          note.attatchmentURL = await Storage.vault.get(attatchment);\n        }\n\n        setContent(content);\n        setNote(note);\n      } catch (e) {\n        onError(e);\n      }\n    }\n\n    onLoad();\n  }, [id]);\n\n  function validateForm() {\n    return content.length > 0;\n  }\n\n  function formatFilename(str) {\n    return str.replace(/^\\w+-/, \"\");\n  }\n\n  function handleFileChange(event) {\n    file.current = event.target.files[0];\n  }\n\n  async function handleSubmit(event) {\n    let attatchment;\n    event.preventDefault();\n\n    if (file.current && file.current.size > config.MAX_ATTATCHMENT_SIZE) {\n      alert(`Please pick a file smaller than ${config.MAX_ATTATCHMENT_SIZE / 1000000} MB.`);\n      return;\n    }\n\n    setIsLoading(true);\n  }\n\n  async function handleDelete(event) {\n    event.preventDefault();\n    const confirmed = window.confirm(\"Are you sure you want to delete?\");\n\n    if (!confirmed) {\n      return;\n    }\n\n    setIsDeleting(true);\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"Notes\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 9\n    }\n  }, note && /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FormGroup, {\n    controlId: \"content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(FormControl, {\n    value: content,\n    componentClass: \"textarea\",\n    onChange: e => setContent(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 25\n    }\n  })), note.attachment && /*#__PURE__*/React.createElement(FormGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(ControlLabel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 29\n    }\n  }, \"Attachment\"), /*#__PURE__*/React.createElement(FormControl.Static, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(\"a\", {\n    target: \"_blank\",\n    rel: \"noopener noreferrer\",\n    href: note.attachmentURL,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 29\n    }\n  }, formatFilename(note.attachment)))), /*#__PURE__*/React.createElement(FormGroup, {\n    controlId: \"file\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 21\n    }\n  }, !note.attachment && /*#__PURE__*/React.createElement(ControlLabel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 42\n    }\n  }, \"Attachment\"), /*#__PURE__*/React.createElement(FormControl, {\n    onChange: handleFileChange,\n    type: \"file\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(LoaderButton, {\n    block: true,\n    type: \"submit\",\n    bsSize: \"large\",\n    bsStyle: \"primary\",\n    isLoading: isLoading,\n    disabled: !validateForm(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 21\n    }\n  }, \"Save\"), /*#__PURE__*/React.createElement(LoaderButton, {\n    block: true,\n    bsSize: \"large\",\n    bsStyle: \"danger\",\n    onClick: handleDelete,\n    isLoading: isDeleting,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 21\n    }\n  }, \"Delete\")));\n}","map":{"version":3,"sources":["/Users/carsonvache/Documents/CrowdsourcedMedicalImageDatabase/notes-front-end/src/containers/Notes.js"],"names":["React","useRef","useState","useEffect","useParams","useHistory","FormGroup","FormControl","ControlLabel","API","Storage","LoaderButton","onError","config","Notes","file","id","history","note","setNote","content","setContent","isLoading","setIsLoading","isDeleting","setIsDeleting","loadNote","get","onLoad","attatchment","attatchmentURL","vault","e","validateForm","length","formatFilename","str","replace","handleFileChange","event","current","target","files","handleSubmit","preventDefault","size","MAX_ATTATCHMENT_SIZE","alert","handleDelete","confirmed","window","confirm","value","attachment","attachmentURL"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect } from \"react\";\nimport { useParams, useHistory } from \"react-router-dom\";\nimport { FormGroup, FormControl, ControlLabel } from 'react-bootstrap';\nimport { API, Storage } from \"aws-amplify\";\nimport LoaderButton from \"../components/LoaderButton\";\nimport { onError } from \"../libs/errorLib\";\nimport config from \"../config\";\nimport './Notes.css';\n\n\nexport default function Notes() {\n    const file = useRef(null);\n    const {id} = useParams();\n    const history = useHistory();\n    const [note, setNote] = useState(null);\n    const [content, setContent] = useState(\"\");\n    const [isLoading, setIsLoading] = useState(false);\n    const [isDeleting, setIsDeleting] = useState(false);\n\n    useEffect(() => {\n        function loadNote() {\n            return API.get(\"notes\", `/notes/${id}`);\n        }\n\n        async function onLoad() {\n            try {\n                const note = await loadNote();\n                const {content, attatchment} = note;\n                \n                if (attatchment) {\n                    note.attatchmentURL = await Storage.vault.get(attatchment);\n                }\n\n                setContent(content);\n                setNote(note);\n            } catch (e) {\n                onError(e);\n            }\n        }\n\n        onLoad();\n    }, [id]);\n\n    function validateForm() {\n        return content.length > 0;\n    }\n\n    function formatFilename(str) {\n        return str.replace(/^\\w+-/, \"\");\n    }\n\n    function handleFileChange(event) {\n        file.current = event.target.files[0];\n    }\n\n    async function handleSubmit(event) {\n        let attatchment;\n\n        event.preventDefault();\n\n        if(file.current && file.current.size > config.MAX_ATTATCHMENT_SIZE) {\n            alert(\n                `Please pick a file smaller than ${config.MAX_ATTATCHMENT_SIZE /\n                1000000} MB.`\n            );\n            return;\n        }\n        setIsLoading(true);\n    }\n\n    async function handleDelete(event) {\n        event.preventDefault();\n\n        const confirmed = window.confirm(\n            \"Are you sure you want to delete?\"\n        );\n\n        if (!confirmed) {\n            return;\n        }\n\n        setIsDeleting(true);\n    }\n\n    return (\n        <div className='Notes'>\n            {note && (\n                <form onSubmit={handleSubmit}>\n                    <FormGroup controlId='content'>\n                        <FormControl\n                            value={content}\n                            componentClass=\"textarea\"\n                            onChange={ e => setContent(e.target.value)}\n                        />\n                    </FormGroup>\n                    {note.attachment && (\n                        <FormGroup>\n                            <ControlLabel>Attachment</ControlLabel>\n                            <FormControl.Static>\n                            <a\n                                target=\"_blank\"\n                                rel=\"noopener noreferrer\"\n                                href={note.attachmentURL}\n                            >\n                                {formatFilename(note.attachment)}\n                            </a>\n                            </FormControl.Static>\n                        </FormGroup>\n                    )}\n                    <FormGroup controlId=\"file\">\n                    {!note.attachment && <ControlLabel>Attachment</ControlLabel>}\n                    <FormControl onChange={handleFileChange} type=\"file\" />\n                    </FormGroup>\n                    <LoaderButton\n                    block\n                    type=\"submit\"\n                    bsSize=\"large\"\n                    bsStyle=\"primary\"\n                    isLoading={isLoading}\n                    disabled={!validateForm()}\n                    >\n                    Save\n                    </LoaderButton>\n                    <LoaderButton\n                    block\n                    bsSize=\"large\"\n                    bsStyle=\"danger\"\n                    onClick={handleDelete}\n                    isLoading={isDeleting}\n                    >\n                    Delete\n                    </LoaderButton>\n                </form>\n            )}\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}