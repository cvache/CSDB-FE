{"ast":null,"code":"var _jsxFileName = \"/Users/carsonvache/Documents/CrowdsourcedMedicalImageDatabase/Site/FE/src/containers/Notes.js\";\nimport React, { useRef, useState, useEffect } from \"react\";\nimport { useParams, useHistory } from \"react-router-dom\";\nimport { Tabs } from 'react-bootstrap';\nimport { API, Storage } from \"aws-amplify\";\nimport LoaderButton from \"../components/LoaderButton\";\nimport { s3Upload } from \"../libs/awsLib\";\nimport { onError } from \"../libs/errorLib\";\nimport config from \"../config\";\nimport './Notes.css';\nexport default function Notes() {\n  const file = useRef(null);\n  const {\n    id\n  } = useParams();\n  const history = useHistory();\n  const [note, setNote] = useState(null);\n  const [content, setTitle] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [isDeleting, setIsDeleting] = useState(false);\n  useEffect(() => {\n    function loadNote() {\n      return API.get(\"notes\", `/images/${id}`);\n    }\n\n    async function onLoad() {\n      try {\n        const note = await loadNote();\n        const {\n          title,\n          imgName\n        } = note;\n\n        if (imgName) {\n          note.attatchmentURL = await Storage.vault.get(imgName);\n        }\n\n        setTitle(title);\n        setNote(note);\n      } catch (e) {\n        onError(e);\n      }\n    }\n\n    onLoad();\n  }, [id]);\n\n  function formatFilename(str) {\n    return str.replace(/^\\w+-/, \"\");\n  }\n\n  function handleFileChange(event) {\n    file.current = event.target.files[0];\n  }\n\n  function saveNote(note) {\n    return API.put(\"notes\", `/notes/${id}`, {\n      body: note\n    });\n  }\n\n  async function handleSubmit(event) {\n    let attachment;\n    event.preventDefault();\n\n    if (file.current && file.current.size > config.MAX_ATTACHMENT_SIZE) {\n      alert(`Please pick a file smaller than ${config.MAX_ATTACHMENT_SIZE / 1000000} MB.`);\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      if (file.current) {\n        attachment = await s3Upload(file.current);\n      }\n\n      await saveNote({\n        content,\n        attachment: attachment || note.attachment\n      });\n      history.push(\"/\");\n    } catch (e) {\n      onError(e);\n      setIsLoading(false);\n    }\n  }\n\n  function deleteNote() {\n    return API.del(\"notes\", `/notes/${id}`);\n  }\n\n  async function handleDelete(event) {\n    event.preventDefault();\n    const confirmed = window.confirm(\"Are you sure you want to delete this note?\");\n\n    if (!confirmed) {\n      return;\n    }\n\n    setIsDeleting(true);\n\n    try {\n      await deleteNote();\n      history.push(\"/\");\n    } catch (e) {\n      onError(e);\n      setIsDeleting(false);\n    }\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ImgSection\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Tabs, {\n    defaultActiveKey: \"Image\",\n    id: \"infoTabs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }\n  }));\n}","map":{"version":3,"sources":["/Users/carsonvache/Documents/CrowdsourcedMedicalImageDatabase/Site/FE/src/containers/Notes.js"],"names":["React","useRef","useState","useEffect","useParams","useHistory","Tabs","API","Storage","LoaderButton","s3Upload","onError","config","Notes","file","id","history","note","setNote","content","setTitle","isLoading","setIsLoading","isDeleting","setIsDeleting","loadNote","get","onLoad","title","imgName","attatchmentURL","vault","e","formatFilename","str","replace","handleFileChange","event","current","target","files","saveNote","put","body","handleSubmit","attachment","preventDefault","size","MAX_ATTACHMENT_SIZE","alert","push","deleteNote","del","handleDelete","confirmed","window","confirm"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useEffect } from \"react\";\nimport { useParams, useHistory } from \"react-router-dom\";\nimport { Tabs } from 'react-bootstrap';\nimport { API, Storage } from \"aws-amplify\";\nimport LoaderButton from \"../components/LoaderButton\";\nimport { s3Upload } from \"../libs/awsLib\";\nimport { onError } from \"../libs/errorLib\";\nimport config from \"../config\";\nimport './Notes.css';\n\n\nexport default function Notes() {\n    const file = useRef(null);\n    const {id} = useParams();\n    const history = useHistory();\n    const [note, setNote] = useState(null);\n    const [content, setTitle] = useState(\"\");\n    const [isLoading, setIsLoading] = useState(false);\n    const [isDeleting, setIsDeleting] = useState(false);\n\n    useEffect(() => {\n        function loadNote() {\n            return API.get(\"notes\", `/images/${id}`);\n        }\n\n        async function onLoad() {\n            try {\n                const note = await loadNote();\n                const {title, imgName} = note;\n                \n                if (imgName) {\n                    note.attatchmentURL = await Storage.vault.get(imgName);\n                }\n\n                setTitle(title);\n                setNote(note);\n            } catch (e) {\n                onError(e);\n            }\n        }\n\n        onLoad();\n    }, [id]);\n\n    function formatFilename(str) {\n        return str.replace(/^\\w+-/, \"\");\n    }\n\n    function handleFileChange(event) {\n        file.current = event.target.files[0];\n    }\n\n    function saveNote(note) {\n        return API.put(\"notes\", `/notes/${id}`, {\n          body: note\n        });\n      }\n      \n      async function handleSubmit(event) {\n        let attachment;\n      \n        event.preventDefault();\n      \n        if (file.current && file.current.size > config.MAX_ATTACHMENT_SIZE) {\n          alert(\n            `Please pick a file smaller than ${\n              config.MAX_ATTACHMENT_SIZE / 1000000\n            } MB.`\n          );\n          return;\n        }\n      \n        setIsLoading(true);\n      \n        try {\n          if (file.current) {\n            attachment = await s3Upload(file.current);\n          }\n      \n          await saveNote({\n            content,\n            attachment: attachment || note.attachment\n          });\n          history.push(\"/\");\n        } catch (e) {\n          onError(e);\n          setIsLoading(false);\n        }\n      }\n\n    function deleteNote() {\n        return API.del(\"notes\", `/notes/${id}`);\n    }\n    \n    async function handleDelete(event) {\n        event.preventDefault();\n    \n        const confirmed = window.confirm(\n            \"Are you sure you want to delete this note?\"\n        );\n    \n        if (!confirmed) {\n            return;\n        }\n        \n        setIsDeleting(true);\n        \n        try {\n            await deleteNote();\n            history.push(\"/\");\n        } catch (e) {\n            onError(e);\n            setIsDeleting(false);\n        }\n    }\n\n    return (\n        <div className='ImgSection'>\n            <Tabs defaultActiveKey='Image' id='infoTabs'>\n\n            </Tabs>\n        </div>\n    );\n}"]},"metadata":{},"sourceType":"module"}